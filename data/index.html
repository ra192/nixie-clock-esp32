<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pulsar nixie clock</title>
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="coloris.min.css" rel="stylesheet" />
</head>

<body>
    <div class="accordion" id="accordion">
        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                    Time settings
                </button>
            </h2>
            <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordion">
                <div class="accordion-body">
                    <form action="/save-time" method="POST">
                        <div class="row mb-3">
                            <label for="time" class="col-sm-2 col-form-label">Time</label>
                            <div class="col-sm-4">
                                <input type="time" class="form-control" id="time" name="time" step="1">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="date" class="col-sm-2 col-form-label">Date</label>
                            <div class="col-sm-4">
                                <input type="date" class="form-control" id="date" name="date">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="sync_time" class="col-sm-2 col-form-label">Sync time</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="sync_time" name="sync_time">
                                    <option value="1">on</option>
                                    <option value="0">off</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="time_zone" class="col-sm-2 col-form-label">Time zone</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="time_zone" name="time_zone">
                                    <option value="EET-2EEST,M3.5.0/3,M10.5.0/4">Europe/Kiev</option>
                                    <option value="GMT0BST,M3.5.0/1,M10.5.0">Europe/London</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="24h_format" class="col-sm-2 col-form-label">12/24 format</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="24h_format" name="24h_format">
                                    <option value="0">12h</option>
                                    <option value="1">24h</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    Settings
                </button>
            </h2>
            <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordion">
                <div class="accordion-body">
                    <form action="/save-settings" method="POST">
                        <div class="row mb-3">
                            <label for="nixie_bright" class="col-sm-2 col-form-label">Nixie brightness</label>
                            <div class="col-sm-4">
                                <input type="number" class="form-control" id="nixie_bright" name="nixie_bright" min="32"
                                    max="255">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="night_bright" class="col-sm-2 col-form-label">Night brightness percent</label>
                            <div class="col-sm-4">
                                <input type="number" class="form-control" id="night_bright" name="night_bright" min="0"
                                    max="100">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="night_from" class="col-sm-2 col-form-label">Night from</label>
                            <div class="col-sm-4">
                                <input type="time" class="form-control" id="night_from" name="night_from">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="night_to" class="col-sm-2 col-form-label">Night to</label>
                            <div class="col-sm-4">
                                <input type="time" class="form-control" id="night_to" name="night_to">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="display_mode" class="col-sm-2 col-form-label">Display mode</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="display_mode" name="display_mode">
                                    <option value="0">Time</option>
                                    <option value="1">Time and date</option>
                                    <option value="2">Time and temperature</option>
                                    <option value="3">Time, date and temperature</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="disp_mode_freq" class="col-sm-2 col-form-label">Show every</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="disp_mode_freq" name="disp_mode_freq">
                                    <option value="0">30 sec</option>
                                    <option value="1">Minute</option>
                                    <option value="2">Two minute</option>
                                    <option value="3">Five minute</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="trans_effect" class="col-sm-2 col-form-label">Nixie effect</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="trans_effect" name="trans_effect">
                                    <option value="0">None</option>
                                    <option value="1">Shift left</option>
                                    <option value="2">Shift right</option>
                                    <option value="3">Flip all</option>
                                    <option value="4">Flip seq</option>
                                    <option value="5">Fade</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="digit_effect" class="col-sm-2 col-form-label">Digit effect</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="digit_effect" name="digit_effect">
                                    <option value="0">None</option>
                                    <option value="1">Flip all</option>
                                    <option value="2">Flip seq</option>
                                    <option value="3">Fade</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="celsius_temp" class="col-sm-2 col-form-label">Temp in C/F</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="celsius_temp" name="celsius_temp">
                                    <option value="0">F</option>
                                    <option value="1">C</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="dot_brightness" class="col-sm-2 col-form-label">Dot brightness</label>
                            <div class="col-sm-4">
                                <input type="number" class="form-control" id="dot_brightness" name="dot_brightness"
                                    min="32" max="255">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="dot_mode" class="col-sm-2 col-form-label">Dot mode</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="dot_mode" name="dot_mode">
                                    <option value="0">Off</option>
                                    <option value="1">On</option>
                                    <option value="2">Blink</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                    Led settings
                </button>
            </h2>
            <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordion">
                <div class="accordion-body">
                    <form action="/save-led-settings" method="POST">
                        <div class="row mb-3">
                            <label for="led_bright" class="col-sm-2 col-form-label">Led brightness</label>
                            <div class="col-sm-4">
                                <input type="number" class="form-control" id="led_bright" name="led_bright" max="255">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="led_mode" class="col-sm-2 col-form-label">Led mode</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="led_mode" name="led_mode">
                                    <option value="0">None</option>
                                    <option value="1">Static color</option>
                                    <option value="2">Rainbow</option>
                                    <option value="3">Rainbow 2</option>
                                    <option value="4">Fade</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="led_color" class="col-sm-2 col-form-label">Led color</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="led_color" name="led_color" data-coloris>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                    WiFi settings
                </button>
            </h2>
            <div id="collapseFour" class="accordion-collapse collapse" data-bs-parent="#accordion">
                <div class="accordion-body">
                    <form action="/save-wifi-creds" method="POST">
                        <div class="row mb-3">
                            <label for="ssid" class="col-sm-2 col-form-label">ssid</label>
                            <div class="col-sm-4">
                                <select class="form-select" id="ssid" name="ssid"></select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="password" class="col-sm-2 col-form-label">Password</label>
                            <div class="col-sm-4">
                                <input type="password" class="form-control" id="password" name="password">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="hostname" class="col-sm-2 col-form-label">Hostname</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="hostname" name="hostname">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="bootstrap.bundle.min.js"></script>
    <script src="coloris.min.js"></script>
    <script>
        document.getElementById('time').value = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
        document.getElementById("date").valueAsDate = new Date();

        fetch('/get-time').then(response => response.json()).then(data => {
            document.getElementById('sync_time').value = data['sync_time'];
            document.getElementById('time_zone').value = data['time_zone'];
            document.getElementById('24h_format').value = data['24h_format'];
        });

        fetch('/get-settings').then(response => response.json()).then(data => {
            document.getElementById('nixie_bright').value = data['nixie_bright'];
            document.getElementById('night_bright').value = data['night_bright'];
            document.getElementById('night_from').value = data['night_from'];
            document.getElementById('night_to').value = data['night_to'];
            document.getElementById('display_mode').value = data['display_mode'];
            document.getElementById('disp_mode_freq').value = data['disp_mode_freq'];
            document.getElementById('trans_effect').value = data['trans_effect'];
            document.getElementById('digit_effect').value = data['digit_effect'];
            document.getElementById('celsius_temp').value = data['celsius_temp'];
            document.getElementById('dot_brightness').value = data['dot_brightness'];
            document.getElementById('dot_mode').value = data['dot_mode'];
        });

        fetch('/get-led-settings').then(response => response.json()).then(data => {
            document.getElementById('led_bright').value = data['led_bright'];
            document.getElementById('led_color').value = data['led_color'];
            document.getElementById('led_mode').value = data['led_mode'];

            Coloris({
                alpha: false
            });
        });

        fetch('/get-network-settings').then(response => response.json()).then(data => {
            var ssidElem = document.getElementById('ssid');
            var ssidList = data['ssid_list'];

            ssidList.forEach(ssidItm => {
                var option = document.createElement('option');

                option.text = ssidItm;
                option.value = ssidItm;

                ssidElem.appendChild(option);
            });

            ssidElem.value = data['ssid']
            document.getElementById('hostname').value = data['hostname'];
        });
    </script>
</body>

</html>